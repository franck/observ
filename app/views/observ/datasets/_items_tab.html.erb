<section class="observ-card">
  <div class="observ-card__header">
    <h2 class="observ-card__title">Dataset Items</h2>
    <%= link_to "Add Item", new_dataset_item_path(@dataset), class: "observ-button observ-button--sm observ-button--primary" %>
  </div>
  <div class="observ-card__body">
    <% if @items.any? %>
      <table class="observ-table">
        <thead class="observ-table__header">
          <tr class="observ-table__row">
            <th class="observ-table__cell">Input</th>
            <th class="observ-table__cell">Expected Output</th>
            <th class="observ-table__cell">Status</th>
            <th class="observ-table__cell observ-table__cell--numeric">Runs</th>
            <th class="observ-table__cell">Created</th>
            <th class="observ-table__cell observ-table__cell--actions"></th>
          </tr>
        </thead>
        <tbody>
          <% @items.each do |item| %>
            <tr class="observ-table__row">
              <td class="observ-table__cell observ-datasets__cell--preview">
                <code class="observ-datasets__preview"><%= item.input_preview(max_length: 80) %></code>
              </td>
              <td class="observ-table__cell observ-datasets__cell--preview">
                <% if item.expected_output.present? %>
                  <code class="observ-datasets__preview"><%= item.expected_output_preview(max_length: 80) %></code>
                <% else %>
                  <span class="observ-text--muted">Not set</span>
                <% end %>
              </td>
              <td class="observ-table__cell">
                <span class="observ-badge <%= item.active? ? 'observ-badge--success' : 'observ-badge--default' %>">
                  <%= item.status %>
                </span>
              </td>
              <td class="observ-table__cell observ-table__cell--numeric">
                <%= item.run_count %>
              </td>
              <td class="observ-table__cell">
                <%= time_ago_in_words(item.created_at) %> ago
              </td>
              <td class="observ-table__cell observ-table__cell--actions">
                <div class="observ-datasets-table__action-group">
                  <%= link_to "Edit", edit_dataset_item_path(@dataset, item), class: "observ-button observ-button--sm" %>
                  <%= button_to "Delete", dataset_item_path(@dataset, item),
                    method: :delete,
                    class: "observ-button observ-button--sm observ-button--danger",
                    data: { confirm: "Are you sure you want to delete this item?" } %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <%= observ_pagination(@items) %>
    <% else %>
      <div class="observ-card__empty">
        <p class="observ-card__empty-text">No items in this dataset</p>
        <p class="observ-card__empty-subtext">Add test cases to start evaluating your agent</p>
        <%= link_to "Add your first item", new_dataset_item_path(@dataset), class: "observ-button observ-button--primary" %>
      </div>
    <% end %>
  </div>
</section>
