<% content_for :title, "Session #{truncate_id(@session.session_id, 12)}" %>

<% content_for :page_header do %>
  <div class="observ-page-header__content">
    <div class="observ-page-header__breadcrumb">
      <%= link_to "Sessions", sessions_path, class: "observ-link" %> /
    </div>
    <h1 class="observ-page-header__title">
      Session <code class="observ-code observ-code--inline"><%= truncate_id(@session.session_id, 12) %></code>
    </h1>
    <div class="observ-page-header__meta">
      <%= observ_status_badge(observ_session_status(@session)) %>
    </div>
  </div>
  <div class="observ-page-header__actions">
    <%= link_to "#", 
        class: "observ-button observ-button--primary observ-button--sm",
        data: { 
          action: "click->observ--drawer#open", 
          drawer_url_param: annotations_drawer_session_path(@session)
        } do %>
      Annotate
      <% if @session.annotations.any? %>
        <span class="observ-badge observ-badge--light"><%= @session.annotations.count %></span>
      <% end %>
    <% end %>
  </div>
<% end %>

<div class="observ-container">
  <%= render "observ/sessions/metrics", session_metrics: @session_metrics, session: @session %>

  <%= render "observ/sessions/metadata", session: @session %>

  <%= render "observ/sessions/traces", traces: @traces, session: @session %>

  <%= render "observ/sessions/chat", chat: @chat %>
</div>
